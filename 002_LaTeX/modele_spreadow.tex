Jak pokazał rozdział \ref{sec:popularne_spready}, spready mogą powstawać w naturalny sposób pomiędzy różnymi rodzajamy aktywów co powoduje, że ich modelowanie nie jest proste. Możemy podać prosty przykład ilustrujący problem rozważając dwa spready: \emph{spark spread}, oraz \emph{LIBOR-OIS} spread. Pierwszy jest różnicą między ceną sprzedanej energii a ceną gazu ziemnego z którego została wyprodukowana. Komponent ,,energetyczny"~spreadu porusza się zgodnie z dynamiką charakterystyczną dla rynku energii. Można spodziewać się ciężkoogonowości dziennych zmian, ostrych pików cenowych jak i równie szybkich powrotów do średniej, czy regularnej sezonowości spowodowanej zmianami popytu na elektryczność w obrębie dnia. Gaz ziemny natomiast wykazuje obecne, choć mniej agresywne piki cenowe, sezonowość w obrębie roku, oraz podobnie jak dla cen energii \emph{mean-reversion} i ciężkie ogony przejawiające się w jego dynamice \cite{Espen_Crack_Spread_Copula}. Crack spread, będąc ich różnicą, jest ciężkoogonowy, asymetryczny, potrafiący osiągać zarówno dodatnie jak i ujemne wartości. LIBOR-OIS spread z drugiej strony jest różnicą między dwoma stopami procentowymi - w porównaniu z crack spreadem jest względnie stabilny, dodatni, i nie wykazuje sezonowości. W momentach kryzysów o podłożu kredytowym, potrafi jednak wykazać bardzo ciężki prawy ogon i zwielokrotnić swoje wartości w bardzo krótkim okresie czasu \cite{Libor_OIS_model}.\\

Dynamika spreadu jest więc wypadkową dynamiki jego komponentów. Zatem model przystosowany do jednego spreadu może nie uchwycać \emph{stylized facts} dotyczących dynamiki innego spreadu. Z tego powodu modele specyfikowane są raczej do konkretnej klasy spreadów i nie da się wskazać jednego, dominującego modelu odpowiedniego do każdej sytuacji. Podejście kopułowe opisane niżej jest jednym z najbardziej uogólnionych podejść, pozwalającym na osobne modelowanie jednowymiarowych modeli szeregów czasowych dla komponentów spreadu i swobodne łączenie ich dzięki elastyczności kopuł w spójny model dla samego spreadu.
W tym rozdziale naszkicujemy popularne sposoby modelowania spreadu i wskażemy drogę generalizowania od najprostszej idei modelu Blacka-Scholesa do modelu kopułowego.

\subsubsection{Modele Blacka-Scholesa oraz Bacheliera}

Najprostszą ideą jest zaadaptowanie dobrze znanego i popularnego modelu Blacka-Scholesa \cite{Black_Scholes} do modelowania komponentów spreadu. Takie podejście zaprezentowane jest w \cite{Bjerksund_Spread_Options_Lognormal}. Dynamika komponentów wyrażana jest tu poprzez stochastyczne równanie różniczkowe:

$$ dS_i(t) = \mu_i S_i(t)dt + \sigma_i S_i(t)dW_i(t),$$

dla $\mu_i \in \R$, $\sigma_i >0$, gdzie $\{W_1(t)\}_t$ i $\{W_2(t)\}_t$ są dwoma procesami Wienera o korelacji $\rho$.\\

Podejście to powoduje, że ceny aktywów $S_1(t)$ i $S_2(t)$ są nieujemne, o znanym rozkładzie lognormalnym, oraz mamy dostępną dobrze wypracowaną teorię dotyczącą zachowania modelu i wyceny instrumentów pochodnych. Mimo tych zalet model ten nie zyskał jednak popularności w zastosowaniu do spreadów. Powodem jest fakt, że spready mogą być tworzone na podstawie aktywów które mogą osiągać wartości ujemne~-~w momencie pisania tej pracy w wielu europejskich państwach mamy do czynienia z ujemnymi stopami procentowymi, a nie tak dawno obserwować można było ujemną cenę kontraktu futures na ropę WTI. Dodatkowo model ten nie daje jawnych wzorów na ceny instruentów pochodnych na spread. \\
Zauważono jednak, że w sporej ilości przypadków histogramy spreadu pozwalają się dość dobrze modelować przy pomocy rozkładu normalnego \cite{Carmona_Spread_Options}. Ta obserwacja doprowadziła do zastosowania modelu Bacheliera jako bezpośredniego modelu dla spreadu. Taki pomysł pokazuje \cite{Poitras_Spread_Options_Arithmetic}, stosując model o dynamice:

$$ ds(t) = \mu s(t) dt + \sigma dW(t),$$

pozwalającej spreadom osiągnąć zarówno dodatnie jak i ujemne wartości. Zaletą takiego podejścia nad modelem lognormalnym jest możliwość otrzymania analitycznych wzorów na europejskie opcje na spread (\cite{Poitras_Spread_Options_Arithmetic}). \cite{Carmona_Spread_Options} w swojej pracy dodatkowo pokazują, że ten model choć prosty, zaskakująco dobrze  dopasowuje się do rynkowych cen europejskich opcji na spark spread - w szczególności dla krótkich terminów wygaśnięcia opcji.\\
Mimo tych zalet \cite{Herath_Copula_Crack_Spread}, \cite{Carmona_Spread_Options}, czy \cite{Kim_NonNormal_Spread} wyliczają wiele wad tego modelu: brak struktury autokorelacji, ciężkoogonowości, czy brak sposobu na oddanie struktury zależności między komponentami spreadu. W realnych danych na porządku dziennym znaleźć można empiryczne dowody na statystyczną istotność powyższych własności spreadów (\cite{Kim_NonNormal_Spread}, czy \cite{Schwartz_Ornstein}), w związku z czym poszukiwano innych modeli potrafiących rozwiązać te problemy.

\subsubsection{Model Ornstein'a-Uhlenbecka i szeregi czasowe}

Próbą uwzględnienia autokorelacji w modelach komponentów spreadu jest użycie procesu Ornsteina-Uhlenbecka do modelowania ich dynamiki:

$$ dS_i(t) =S_i(t)[-\lambda (\log S_i(t) - \mu_i)dt + \sigma_i dW_i(t)],$$
gdzie $\lambda_i>0$,  $\mu_i \in \R$, $\sigma_i >0$, oraz $\{W_1(t)\}_t$ i $\{W_2(t)\}_t$ są dwoma procesami Wienera o korelacji $\rho$.\\

Spread jest modelowany wtedy jako różnica tych dwóch procesów. Nie poprawia to problemu gaussowskości procesu czy struktury korelacji między komponentami, oraz dodatkowo zmuszeni jesteśmy do numerycznej analizy rozwiązania. Jest to jednak pierwszy krok w stronę modeli dla komponentów spreadu wykorzystujących techniki modelowania szeregów czasowych. Wychodząc z tej idei pojawiła się liczna lista prac wykorzystujących bardziej zaawansowane modele, w których analityczność jest porzucona w zamian za poprawniejszy modelu opisujący dynamikę komponentów. \cite{Herath_Copula_Crack_Spread}, \cite{Boubaker_Markov_Copula}, \cite{Espen_Crack_Spread_Copula}, czy \cite{Bernard_Pricing_Multivariate_Options_with_copulae} pokazują różne podejścia, od modeli ARMA-GARCH, przez procesy Levy'ego, po modele \emph{Markov switching regime} do opisu komponentów spreadu, które dobrze radzą sobie z empiryczną ciężkoogonowością i rozwiązują problem gaussowskości.\\

Wybór modeli dla komponentów spreadu można więc uzależnić od rodzaju modelowanego aktywa, w sposób uchwycający jego unikatowe własności, co jest najbardziej ogólnym podejściem. Mając wybrane modele dla komponentów spreadu (modele brzegowe), wciąż otwarty pozostaje jednak problem połączenia ich w spójny, łączny model dla spreadu. W modelach Blacka-Scholesa i Ornsteine'a-Uhlenbecka za strukturę zależności odpowiadała korelacja $\rho$ źródeł losowości (procesów Wienera). Zwykła korelacja tam wystarczała, ponieważ posługiwaliśmy się procesami Wienera, o normalnych rozkładach skończenie-wymiarowych. W ogólniejszym podejściu jednak będziemy chcieli osłabić założenie normalności innowacji modelu, przez co potrzebny będzie dokładniejszy opis ich struktury zależności. Tę problematykę poruszymy w kolejnym rozdziale opisując podejście kopułowe.